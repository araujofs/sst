@startuml
title Algoritmo: Simulacao.exportar(formato)
start
:Verificar formato solicitado;
if (Formato == "Excel"?) then (Sim)
    if (Volume de dados > Limite Excel?) then (Sim)
        :Exibir alerta "Simulação muito grande";
        :Recomendar formato CSV;
        stop
    endif
    :Gerar arquivo Excel detalhado;
    note right
      Inclui:
      - Dados financeiros de entrada
      - Resultados por regime
      - Detalhamento de tributos
      - Gráficos (opcional)
    end note
elseif (Formato == "PDF"?) then (Sim)
    :Gerar arquivo PDF formatado;
    note right
      Inclui:
      - Cabeçalho profissional
      - Resumo executivo
      - Detalhamento de cálculos
      - Gráficos comparativos
    end note
else (CSV)
    :Gerar arquivo CSV com dados brutos;
    note right
      Dados tabulares simples
      para integração
    end note
endif
:Retornar arquivo gerado;
:Iniciar download;
stop
@enduml